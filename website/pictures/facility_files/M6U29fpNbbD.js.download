;/*FB_PKG_DELIM*/

__d("LSIssueAttachmentsRangeQuery",["LSGetCursor","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return c.storedProcedure(b("LSGetCursor"),c.i64.cast([0,1])).then(function(a){return a=a,d[0]=a[0],a})},function(e){return c.db.table(17).fetch([[[a[0],a[1]]]]).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[2]=c.i64.cast([0,1]):(e=b.item,d[7]=e.syncGroup,c.i64.neq(d[7],void 0)?d[6]=d[7]:d[6]=c.i64.cast([0,1]),d[2]=d[6])})},function(e){return d[4]=new c.Map(),d[4].set("thread_key",a[0]),d[4].set("media_group",a[1]),d[4].set("max_timestamp_ms",c.i64.cast([2328,1316134911])),d[4].set("cursor",d[0]),d[4].set("sync_group",d[2]),d[4].set("last_loaded_message_id",void 0),d[5]=c.toJSON(d[4]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[5],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):(f=e.item,f.hasMoreBefore?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[2]=c.i64.cast([0,1]):(e=b.item,d[7]=e.syncGroup,c.i64.neq(d[7],void 0)?d[6]=d[7]:d[6]=c.i64.cast([0,1]),d[2]=d[6])})},function(e){return d[4]=new c.Map(),d[4].set("thread_key",a[0]),d[4].set("media_group",a[1]),d[4].set("max_timestamp_ms",f.minTimestampMs),d[4].set("cursor",d[0]),d[4].set("sync_group",d[2]),d[4].set("last_loaded_message_id",void 0),d[5]=c.toJSON(d[4]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[5],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):c.resolve())})}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxIssueAttachmentsRangeQueryStoredProcedure";a.__tables__=["attachments_ranges_v2__generated","threads"];e.exports=a}),null);
__d("LSIssueAttachmentsRangeQueryStoredProcedure",["LSIssueAttachmentsRangeQuery","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSIssueAttachmentsRangeQuery"),e.threadKey,e.mediaGroup);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MDSShareSvgIcon.react",["MDSSvgIcon.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(4),e,f;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=i.jsx("path",{d:"M18.766 4.857a1 1 0 00-1.532 0L13.878 8.86a1 1 0 00.766 1.643H16.5a.25.25 0 01.25.25v10.75a1 1 0 001 1h.5a1 1 0 001-1v-10.75a.25.25 0 01.25-.25h1.856a1 1 0 00.766-1.643l-3.356-4.002z"}),f=i.jsx("path",{d:"M14.75 13.502a1 1 0 00-1-1H12.5a4 4 0 00-4 4v8.5a4 4 0 004 4h11a4 4 0 004-4v-8.5a4 4 0 00-4-4h-1.25a1 1 0 00-1 1v.5a1 1 0 001 1h1.25a1.5 1.5 0 011.5 1.5v8.5a1.5 1.5 0 01-1.5 1.5h-11a1.5 1.5 0 01-1.5-1.5v-8.5a1.5 1.5 0 011.5-1.5h1.25a1 1 0 001-1v-.5z"}),b[0]=e,b[1]=f):(e=b[0],f=b[1]);b[2]!==a?(e=i.jsxs(c("MDSSvgIcon.react"),babelHelpers["extends"]({},a,{children:[e,f]})),b[2]=a,b[3]=e):e=b[3];return e}g["default"]=a}),98);
__d("MWChatAttachmentMediaState.react",["$InternalEnum","I64","LSIntEnum","MAWGetIsMediaDownloadStatusEnabled","MAWStateContext.react","MAWVideoAudioPlaybackErrorHandlerUtils","MessagingAttachmentType","RavenMessagingState","ReQL","ReQLSuspense","cr:10985","cr:7625","emptyFunction","filterNulls","justknobx","react","react-compiler-runtime","usePrevious","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=i||(i=d("react"));e=i;var m=e.createContext;e.useCallback;var n=e.useContext,o=e.useEffect,p=e.useMemo,q=e.useRef,r=e.useState,s=(e=b("cr:10985"))!=null?e:{maybeDownloadMediaInWorker:c("emptyFunction")},t=b("$InternalEnum")({Image:0,Video:1}),u=m({canMoveBackward:!1,canMoveForward:!1,card:void 0,cards:[],currentIndex:0,moveBackward:function(){},moveForward:function(){},moveTo:function(){},numberOfCards:0,shouldTriggerLoadMore:!1});function v(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(j||(j=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_IMAGE))&&(j||(j=d("I64"))).equal(a,(k||(k=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function w(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(j||(j=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_VIDEO))&&(j||(j=d("I64"))).equal(a,(k||(k=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function x(a,b,c,d){return c?d.hasMedia:b(d,"isPlayableMedia")!=null&&a(d,"isPlayableMedia")!=null}function y(a,b,e,f){var g=f.attachmentType;return!x(a,b,e,f)?!1:v(f)||(j||(j=d("I64"))).equal(g,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))}function z(a,b,e,f,g){var h=f.attachmentFbid,i=f.attachmentType,l=!1,m=!1;if(d("MAWVideoAudioPlaybackErrorHandlerUtils").isVideoFallbackExperiencesEnabled({silent:!1})){var n=g!=null&&Object.prototype.hasOwnProperty.call(g,f.attachmentFbid);if(n){g=(n=g[h])!=null?n:{};h=g.validationResult;l=h!=null?d("MAWVideoAudioPlaybackErrorHandlerUtils").isInvalidVideo(f,h):!1;m=h!=null?d("MAWVideoAudioPlaybackErrorHandlerUtils").isUnsupportedVideo(f,h):!1}}return!x(a,b,e,f)||l||m?!1:w(f)||(j||(j=d("I64"))).equal(i,(k||(k=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function A(a,b){o(function(){a.forEach(function(a){try{a.attachment.hasMedia&&b(a.attachment,"usePreloadThumbnails");return}catch(a){return}})},[a,b])}function B(a){var e=a.attachments,f=a.children,g=a.getIsSecureThread,h=a.getPlayableUrl,i=a.getPreviewUrl;a=a.initialAttachment;a=r(a);var j=a[0],k=a[1];a=c("usePrevious")(j==null?void 0:j.messageId);var m=d("MAWStateContext.react").useMAWSelector(function(a){return a.mediaDownloadStatus}),v=n(d("MAWStateContext.react").MAWDispatchContext),w=q(new Map());o(function(){!c("justknobx")._("3011")?e.forEach(function(a){var b=g(a);b&&a.hasMedia===!1&&s.maybeDownloadMediaInWorker({attachment:a,dispatch:v,mediaRenderQpl:null,triggerUIView:"fullsize"})}):d("MAWGetIsMediaDownloadStatusEnabled").getIsMediaDownloadStatusEnabled()||e.forEach(function(a){var b,c=g(a);b=(b=w.current.get(a.attachmentFbid))!=null?b:!1;c&&a.hasMedia===!1&&!b&&(w.current.set(a.attachmentFbid,!0),s.maybeDownloadMediaInWorker({attachment:a,dispatch:v,mediaRenderQpl:null,triggerUIView:"fullsize"}))})},[e,v,g]);var x=p(function(){return e.map(function(a){return{attachment:a,mediaRenderQpl:null,statusKey:a.attachmentFbid}})},[e]);b("cr:7625")(x,"fullsize");var B=p(function(){return c("filterNulls")(e.map(function(a){var b=g(a);if(y(h,i,b,a))return{attachment:a,type:t.Image};return z(h,i,b,a,m)?{attachment:a,type:t.Video}:null}))},[e,g,h,i,m]),C=j==null?-1:B.findIndex(function(a){return a.attachment.attachmentFbid===j.attachmentFbid&&a.attachment.messageId===j.messageId}),D=a!=null&&(j==null?void 0:j.messageId)!==a&&C>B.length-5;A(B,i);x=p(function(){var a=Math.max(0,B.length-1);return{canMoveBackward:C>0&&C!==-1,canMoveForward:C<a&&C!==-1,card:B[C],cards:B,currentIndex:C,moveBackward:function(){var a=Math.max(C-1,0);k((a=B[a])==null?void 0:a.attachment)},moveForward:function(){var b=Math.min(C+1,a);k((b=B[b])==null?void 0:b.attachment)},moveTo:function(a){k(a.attachment)},numberOfCards:B.length,shouldTriggerLoadMore:c("justknobx")._("1571")?D:!1}},[B,C,D]);return l.jsx(u.Provider,{value:x,children:f})}B.displayName=B.name+" [from "+f.id+"]";function a(a){var b=d("react-compiler-runtime").c(27),e=a.attachmentFbid,g=a.children,i=a.getPlayableUrl,j=a.getPreviewUrl,k=a.isSecureThread,m=a.threadKey,n=d("MAWStateContext.react").useMAWSelector(D),o=(h||(h=c("useReStore")))();b[0]!==e||b[1]!==o.tables.attachments||b[2]!==m?(a=function(){return d("ReQL").fromTableAscending(o.tables.attachments).getKeyRange(m).filter(function(a){return a.attachmentFbid===e})},b[0]=e,b[1]=o.tables.attachments,b[2]=m,b[3]=a):a=b[3];var p;b[4]!==e||b[5]!==o||b[6]!==m?(p=[o,m,e],b[4]=e,b[5]=o,b[6]=m,b[7]=p):p=b[7];a=d("ReQLSuspense").useFirst(a,p,f.id+":422");var q;b[8]!==o.tables.attachments||b[9]!==i||b[10]!==j||b[11]!==k||b[12]!==n||b[13]!==m?(p=function(){return d("ReQL").fromTableAscending(o.tables.attachments).getKeyRange(m).filter(function(a){return y(i,j,k,a)||z(i,j,k,a,n)})},q=[o.tables.attachments,m,i,j,k,n],b[8]=o.tables.attachments,b[9]=i,b[10]=j,b[11]=k,b[12]=n,b[13]=m,b[14]=p,b[15]=q):(p=b[14],q=b[15]);p=d("ReQLSuspense").useArray(p,q,f.id+":430");b[16]!==p?(q=[].concat(p).sort(C),b[16]=p,b[17]=q):q=b[17];p=q;q=p;b[18]!==k?(p=function(){return k},b[18]=k,b[19]=p):p=b[19];p=p;var r;b[20]!==a||b[21]!==g||b[22]!==p||b[23]!==i||b[24]!==j||b[25]!==q?(r=l.jsx(B,{attachments:q,getIsSecureThread:p,getPlayableUrl:i,getPreviewUrl:j,initialAttachment:a,children:g}),b[20]=a,b[21]=g,b[22]=p,b[23]=i,b[24]=j,b[25]=q,b[26]=r):r=b[26];return r}function C(a,b){return(j||(j=d("I64"))).compare(b.timestampMs,a.timestampMs)}function D(a){return a.mediaDownloadStatus}g.AttachmentMediaType=t;g.context=u;g.MWChatAttachmentMediaStateProviderFromAttachments=B;g.MWChatAttachmentMediaStateProvider=a}),98);
__d("MWChatAttachmentMediaNavigationHotkeys.react",["fbt","CometKeys","MWChatAttachmentMediaState.react","justknobx","react","react-compiler-runtime","useLayerKeyCommands"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useContext;b.useMemo;var l={key:c("CometKeys").LEFT},m={key:c("CometKeys").RIGHT},n={key:c("CometKeys").ESCAPE},o=h._(/*BTDS*/"__JHASH__6tFY25IlnV4__JHASH__"),p=h._(/*BTDS*/"__JHASH__HYvhkJNYo2M__JHASH__"),q=h._(/*BTDS*/"__JHASH__mWoEKBNqFLb__JHASH__");function a(a){var b=d("react-compiler-runtime").c(12),e=a.children;a=a.onClose;var f=k(d("MWChatAttachmentMediaState.react").context),g=f.moveBackward;f=f.moveForward;var h;b[0]!==g?(h={command:l,description:o,handler:g},b[0]=g,b[1]=h):h=b[1];b[2]!==f?(g={command:m,description:p,handler:f},b[2]=f,b[3]=g):g=b[3];b[4]!==a?(f=a!=null?{command:n,description:q,handler:a}:null,b[4]=a,b[5]=f):f=b[5];b[6]!==h||b[7]!==g||b[8]!==f?(a=[h,g,f].filter(Boolean),b[6]=h,b[7]=g,b[8]=f,b[9]=a):a=b[9];h=a;g=h;c("useLayerKeyCommands")(g);if(b[10]!==e){h=c("justknobx")._("3491")?j.jsx(j.Fragment,{children:(f=e)!=null?f:null}):j.jsx("div",{children:(a=e)!=null?a:null});b[10]=e;b[11]=h}else h=b[11];return h}g.keyLeft=l;g.keyRight=m;g.keyEscape=n;g.MWChatAttachmentMediaNavigationHotkeys=a}),226);
__d("MWV2MediaViewerContext.react",["react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useMemo;var j=i.createContext({getDownloadUrl:function(){},getPlayableUrl:function(){},getPreviewUrl:function(){},heroLoggingComponent:function(a){return null},loadMore:function(){},media:[]});function a(a){var b=d("react-compiler-runtime").c(10),c=a.children,e=a.getDownloadUrl,f=a.getPlayableUrl,g=a.getPreviewUrl,h=a.heroLoggingComponent,k=a.loadMore;a=a.media;var l;b[0]!==e||b[1]!==f||b[2]!==g||b[3]!==h||b[4]!==k||b[5]!==a?(l={getDownloadUrl:e,getPlayableUrl:f,getPreviewUrl:g,heroLoggingComponent:h,loadMore:k,media:a},b[0]=e,b[1]=f,b[2]=g,b[3]=h,b[4]=k,b[5]=a,b[6]=l):l=b[6];e=l;f=e;b[7]!==c||b[8]!==f?(g=i.jsx(j.Provider,{value:f,children:c}),b[7]=c,b[8]=f,b[9]=g):g=b[9];return g}g.context=j;g.MWV2MediaViewerContextProvider=a}),98);
__d("MWChatAttachmentMediaThumbnails.react",["CometMediaViewerFilmstrip.react","CometPlaceholder.react","MWChatAttachmentMediaState.react","MWV2MediaViewerContext.react","gkx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.useDeferredValue;function l(a){var b=a.card,e=a.getPlayableUrl;a=a.getPreviewUrl;var f=b.attachment,g,h="/images/comet/gray.png";if(f.hasMedia===!1)g=h;else{g=(a=a(f,"toFilmstripThumbnail"))!=null?a:h}a=g;b.type===d("MWChatAttachmentMediaState.react").AttachmentMediaType.Video&&!Boolean(g)&&c("gkx")("3368")&&(a=e(f,"toFilmstripThumbnail"));if(b.type===d("MWChatAttachmentMediaState.react").AttachmentMediaType.Image){return{alt:(h=f.accessibilitySummaryText)!=null?h:"",backgroundColor:void 0,height:0,isUseImageResizing:void 0,mediaType:"image",uri:g,width:0}}return{height:0,mediaType:"video",thumbnailUri:g,uri:a,width:0}}function m(a){var b,e=d("react-compiler-runtime").c(23),f=a.activeCard,g=a.cards,h=a.getPreviewUrl,k=a.onSetImage,m=j(d("MWV2MediaViewerContext.react").context);e[0]!==m?(a=function(a,b){return a==null?"":(a=m.getDownloadUrl(a,b))!=null?a:""},e[0]=m,e[1]=a):a=e[1];var n=a;if(e[2]!==g||e[3]!==n||e[4]!==h){e[6]!==n||e[7]!==h?(a=function(a){return l({card:a,getPlayableUrl:n,getPreviewUrl:h})},e[6]=n,e[7]=h,e[8]=a):a=e[8];a=g.map(a);e[2]=g;e[3]=n;e[4]=h;e[5]=a}else a=e[5];a=a;if(e[9]!==(f==null?void 0:(b=f.attachment)==null?void 0:b.attachmentFbid)||e[10]!==(f==null?void 0:(b=f.attachment)==null?void 0:b.messageId)||e[11]!==g){if(e[13]!==(f==null?void 0:(b=f.attachment)==null?void 0:b.attachmentFbid)||e[14]!==(f==null?void 0:(b=f.attachment)==null?void 0:b.messageId)){var o;b=function(a){var b;return a.attachment.attachmentFbid===(f==null?void 0:(b=f.attachment)==null?void 0:b.attachmentFbid)&&a.attachment.messageId===(f==null?void 0:(b=f.attachment)==null?void 0:b.messageId)};e[13]=f==null?void 0:(o=f.attachment)==null?void 0:o.attachmentFbid;e[14]=f==null?void 0:(o=f.attachment)==null?void 0:o.messageId;e[15]=b}else b=e[15];o=g.findIndex(b);e[9]=f==null?void 0:(b=f.attachment)==null?void 0:b.attachmentFbid;e[10]=f==null?void 0:(b=f.attachment)==null?void 0:b.messageId;e[11]=g;e[12]=o}else o=e[12];b=o;e[16]!==g||e[17]!==k?(o=function(a){return k(g[a])},e[16]=g,e[17]=k,e[18]=o):o=e[18];var p;e[19]!==b||e[20]!==a||e[21]!==o?(p=i.jsx(c("CometMediaViewerFilmstrip.react"),{activeIndex:b,images:a,onSetImage:o}),e[19]=b,e[20]=a,e[21]=o,e[22]=p):p=e[22];return p}function a(a){var b=d("react-compiler-runtime").c(6);a=a.getPreviewUrl;var e=j(d("MWChatAttachmentMediaState.react").context),f=e.card,g=e.cards;e=e.moveTo;g=k(g);var h;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(h={className:"xdj266r xkrivgy xat24cr x1gryazu x193iq5w x6ikm8r x10wlt62"},b[0]=h):h=b[0];b[1]!==f||b[2]!==g||b[3]!==a||b[4]!==e?(h=i.jsx("div",babelHelpers["extends"]({},h,{children:i.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWChatAttachmentMediaThumbnails",children:i.jsx(m,{activeCard:f,cards:g,getPreviewUrl:a,onSetImage:e})})})),b[1]=f,b[2]=g,b[3]=a,b[4]=e,b[5]=h):h=b[5];return h}g["default"]=a}),98);
__d("MWChatForwardCircleButton.react",["fbt","FDSCircleButton.react","MDSShareSvgIcon.react","ODS","SVGIcon","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react");function a(a){var b=d("react-compiler-runtime").c(9),e=a.color,f=a.onOpenForwardDialog;a=a.type;var g;b[0]!==e?(g=d("SVGIcon").legacySVGIcon(function(){return k.jsx(c("MDSShareSvgIcon.react"),{color:e,size:24})}),b[0]=e,b[1]=g):g=b[1];var i;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(i=h._(/*BTDS*/"__JHASH__GvPr2MwluxY__JHASH__"),b[2]=i):i=b[2];var l;b[3]!==f?(l=function(){(j||(j=d("ODS"))).bumpEntityKey(3185,"mwchat_media_viewer","forward"),f()},b[3]=f,b[4]=l):l=b[4];bb0:{switch(a){case"deemphasized":a="deemphasized";break bb0;case"normal":a="normal";break bb0;case"overlay":a="overlay";break bb0;case"dark_overlay":a="dark-overlay";break bb0;case"deemphasized_overlay":case"overlay_raised":a="overlay-raised";break bb0;case"primary_background_overlay":a="primary-background-overlay";break bb0}a=void 0}b[5]!==g||b[6]!==l||b[7]!==a?(i=k.jsx(c("FDSCircleButton.react"),{icon:g,label:i,onPress:l,size:36,testid:void 0,type_DEPRECATED:a}),b[5]=g,b[6]=l,b[7]=a,b[8]=i):i=b[8];return i}g["default"]=a}),226);
__d("MWChatMediaViewerControls.react",["fbt","ix","CometRow.react","CometRowItem.react","FDSCircleButton.react","FDSTooltip.react","Int64Hooks","LSFactory","LSIntEnum","LSMessagePointQueryStoredProcedure","LSVerifyThreadRowExistsStoredProcedure","MWChatMessageId","ODS","ReQL","ReQLSuspense","emptyFunction","fbicon","promiseDone","react","react-compiler-runtime","useMWChatForward","useMWV2ForwardMessage","useReStore"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k,l,m,n=m||(m=d("react"));b=m;b.useCallback;var o=b.useState,p={iconHovered:{backgroundColor:"x9lwmrp",$$css:!0}},q=h._(/*BTDS*/"__JHASH__yVgFxyhzJWR__JHASH__"),r=h._(/*BTDS*/"__JHASH__GvPr2MwluxY__JHASH__");function s(a,b){var e=d("react-compiler-runtime").c(18),g=(j||(j=c("useReStore")))(),h,i;e[0]!==g||e[1]!==b?(h=function(){return b!=null?d("ReQL").fromTableAscending(g.tables.threads,["threadType"]).getKeyRange(b).map(t):d("ReQL").empty()},i=[g,b],e[0]=g,e[1]=b,e[2]=h,e[3]=i):(h=e[2],i=e[3]);var l=d("ReQLSuspense").useFirst(h,i,f.id+":68");e[4]!==g||e[5]!==a?(h=function(){return a!=null?d("ReQL").fromTableAscending(g.tables.messages.index("messageId")).getKeyRange(a):d("ReQL").empty()},i=[g,a],e[4]=g,e[5]=a,e[6]=h,e[7]=i):(h=e[6],i=e[7]);var m=d("ReQLSuspense").useFirst(h,i,f.id+":80");e[8]!==g||e[9]!==m||e[10]!==a||e[11]!==l||e[12]!==b?(h=function(){if(a==null||b==null)return;if(l==null){c("promiseDone")(g.runInTransaction(function(a){return c("LSVerifyThreadRowExistsStoredProcedure")(c("LSFactory")(a),{syncGroup:(k||(k=d("LSIntEnum"))).ofNumber(1),threadKey:b})},"readwrite",void 0,void 0,f.id+":96"));return}m==null&&c("promiseDone")(g.runInTransaction(function(d){return c("LSMessagePointQueryStoredProcedure")(c("LSFactory")(d),{messageId:a,threadKey:b,threadType:l})},"readwrite",void 0,void 0,f.id+":109"))},i=[g,m,a,l,b],e[8]=g,e[9]=m,e[10]=a,e[11]=l,e[12]=b,e[13]=h,e[14]=i):(h=e[13],i=e[14]);d("Int64Hooks").useEffectInt64(h,i);e[15]!==m||e[16]!==l?(h=[m,l],e[15]=m,e[16]=l,e[17]=h):h=e[17];return h}function t(a){a=a.threadType;return a}function a(a){var b=d("react-compiler-runtime").c(12),e=a.attachmentID,f=a.canForward,g=a.downloadLink,h=a.isCrossTransportForwardEnabled,j=a.isSecureForwardEnabled;a=a.messageID;f=f===void 0?!0:f;h=h===void 0?!1:h;j=j===void 0?!1:j;var k=o(!1),l=k[0],m=k[1];b[0]!==l||b[1]!==g?(k=g!=null?n.jsx(c("CometRowItem.react"),{children:n.jsx(c("FDSTooltip.react"),{align:"middle",tooltip:q,children:n.jsx(c("FDSCircleButton.react"),{color_DEPRECATED:"white",icon:l?d("fbicon")._(i("1433212"),20):d("fbicon")._(i("1441392"),20),label:q,linkProps:{download:!0,target:"_blank",url:g},onHoverIn:function(a){return m(!0)},onHoverOut:function(a){return m(!1)},overlayHoveredStyle:p.iconHovered,size:36,type_DEPRECATED:"deemphasized"})})}):null,b[0]=l,b[1]=g,b[2]=k):k=b[2];b[3]!==e||b[4]!==f||b[5]!==h||b[6]!==j||b[7]!==a?(l=f===!0?n.jsx(c("CometRowItem.react"),{children:n.jsx(c("FDSTooltip.react"),{align:"middle",tooltip:r,children:n.jsx(v,{attachmentID:e,isCrossTransportForwardEnabled:h,isSecureForwardEnabled:j,messageID:a})})}):null,b[3]=e,b[4]=f,b[5]=h,b[6]=j,b[7]=a,b[8]=l):l=b[8];b[9]!==k||b[10]!==l?(g=n.jsxs(c("CometRow.react"),{paddingTop:0,spacing:8,children:[k,l]}),b[9]=k,b[10]=l,b[11]=g):g=b[11];return g}function u(a){var b=d("react-compiler-runtime").c(9),e=a.isCrossTransportForwardEnabled,f=a.isSecureForwardEnabled,g=a.messageID;a=a.onForwardSend;e=e===void 0?!1:e;f=f===void 0?!1:f;f=f?"secure":e?"cross_transport":"open_";b[0]!==f||b[1]!==g||b[2]!==a?(e={forwardDialogType:f,messageID:g,onClose:c("emptyFunction"),onSend:a},b[0]=f,b[1]=g,b[2]=a,b[3]=e):e=b[3];var h=c("useMWChatForward")(e);b[4]!==h?(f=function(){(l||(l=d("ODS"))).bumpEntityKey(3185,"mwchat_media_viewer","forward"),h&&h.onClick()},b[4]=h,b[5]=f):f=b[5];var j=f;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(g=d("fbicon")._(i("1433236"),20),b[6]=g):g=b[6];b[7]!==j?(a=n.jsx(c("FDSCircleButton.react"),{color_DEPRECATED:"white",icon:g,label:r,onPress:function(a){return j()},overlayHoveredStyle:p.iconHovered,size:36,testid:void 0,type_DEPRECATED:"deemphasized"}),b[7]=j,b[8]=a):a=b[8];return a}function v(a){var b=d("react-compiler-runtime").c(11),c=a.attachmentID,e=a.isCrossTransportForwardEnabled,f=a.isSecureForwardEnabled;a=a.messageID;e=e===void 0?!1:e;f=f===void 0?!1:f;var g;b[0]!==a?(g=d("MWChatMessageId").getMessageId(a),b[0]=a,b[1]=g):g=b[1];g=g;var h;b[2]!==a?(h=d("MWChatMessageId").getThreadId(a),b[2]=a,b[3]=h):h=b[3];h=h;g=s(g,h);h=g[0];g=g[1];if(h==null||g==null)return null;var i;b[4]!==c||b[5]!==e||b[6]!==f||b[7]!==h||b[8]!==a||b[9]!==g?(i=n.jsx(w,{attachmentID:c,isCrossTransportForwardEnabled:e,isSecureForwardEnabled:f,message:h,messageID:a,messageThreadType:g}),b[4]=c,b[5]=e,b[6]=f,b[7]=h,b[8]=a,b[9]=g,b[10]=i):i=b[10];return i}function w(a){var b=d("react-compiler-runtime").c(7),e=a.attachmentID,f=a.isCrossTransportForwardEnabled,g=a.isSecureForwardEnabled,h=a.message,i=a.messageID;a=a.messageThreadType;f=f===void 0?!1:f;g=g===void 0?!1:g;var j=d("useMWV2ForwardMessage").useMWV2ForwardMessage(h,a,e);b[0]!==j?(h=function(a){return c("promiseDone")(j(a))},b[0]=j,b[1]=h):h=b[1];a=h;b[2]!==f||b[3]!==g||b[4]!==i||b[5]!==a?(e=n.jsx(u,{isCrossTransportForwardEnabled:f,isSecureForwardEnabled:g,messageID:i,onForwardSend:a}),b[2]=f,b[3]=g,b[4]=i,b[5]=a,b[6]=e):e=b[6];return e}g["default"]=a}),226);
__d("MWMediaViewerRenderQpl",["MWMediaRenderQplUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MWMediaRenderQplUtils").useCommonMediaRenderQplForAttachment(a,b,"full_screen_view")}g.useMediaViewerRenderQpl=a}),98);
__d("MWSharedAttachmentsSectionHooks",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MessagingAttachmentType","ReQL","ReQLSuspense","gkx","react","react-compiler-runtime","usePrevious","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=k||d("react");l.useCallback;var m=l.useEffect,n=l.useState;function a(a){var b=d("react-compiler-runtime").c(33),e=a.attachmentsRange,f=a.hasMore,g=a.loadMore,h=a.logLoadMediaCancel,i=a.logLoadMediaSuccess,j=a.media,k=a.skipInitialLoad;a=n(!1);var l=a[0],o=a[1],p=j.length,q=(a=c("usePrevious")(p))!=null?a:0,r=c("usePrevious")(f),s=(j=c("usePrevious")(l))!=null?j:!1,t=e!=null;b[0]!==t||b[1]!==g||b[2]!==k?(a=function(){!t&&k!==!0&&(g(),c("gkx")("2616")===!0&&o(!0))},j=[t,g,k],b[0]=t,b[1]=g,b[2]=k,b[3]=a,b[4]=j):(a=b[3],j=b[4]);m(a,j);b[5]!==e||b[6]!==f||b[7]!==l||b[8]!==g||b[9]!==i||b[10]!==p||b[11]!==r||b[12]!==s||b[13]!==q?(a=function(){var a=q!==p,b=r===!0&&!f||e==null&&f===!1&&r===!1&&q===p&&c("gkx")("2616")===!0;l&&(b||a)?(o(!1),i==null?void 0:i({fetchedMediaCount:p-q,startMediaCount:q})):q===p&&f&&l&&s===!0&&c("gkx")("2616")===!0&&(i==null?void 0:i({fetchedMediaCount:p-q,isAlreadyPreloaded:!0,startMediaCount:q}),g())},b[5]=e,b[6]=f,b[7]=l,b[8]=g,b[9]=i,b[10]=p,b[11]=r,b[12]=s,b[13]=q,b[14]=a):a=b[14];b[15]!==e||b[16]!==f||b[17]!==l||b[18]!==g||b[19]!==h||b[20]!==i||b[21]!==p||b[22]!==r||b[23]!==s||b[24]!==q?(j=[p,f,l,q,r,e,g,s,i,h],b[15]=e,b[16]=f,b[17]=l,b[18]=g,b[19]=h,b[20]=i,b[21]=p,b[22]=r,b[23]=s,b[24]=q,b[25]=j):j=b[25];m(a,j);b[26]!==l||b[27]!==g?(h=function(){if(!l){g();return o(!0)}},b[26]=l,b[27]=g,b[28]=h):h=b[28];a=h;j=p>0||!l&&!f;b[29]!==j||b[30]!==l||b[31]!==a?(h=[l,a,j],b[29]=j,b[30]=l,b[31]=a,b[32]=h):h=b[32];return h}function o(a,b,e,g){var i=d("react-compiler-runtime").c(19),j;i[0]!==g?(j=g===void 0?{}:g,i[0]=g,i[1]=j):j=i[1];g=j;j=g.removeUnsentMessages;var k=j===void 0?!1:j,l=(h||(h=c("useReStore")))();g=t(a,b);j=g.attachmentsRange;b=g.hasMoreBefore;var m=g.minTimestampMs,n=g.query;i[2]!==l||i[3]!==e||i[4]!==k?(g=function(a){if(!e(a))return null;if(!k)return a;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(l.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":154");return b==null||b.isUnsent?null:a},i[2]=l,i[3]=e,i[4]=k,i[5]=g):g=i[5];var o=g;i[6]!==o||i[7]!==n?(g=function(){return n.map(o).filter(Boolean)},i[6]=o,i[7]=n,i[8]=g):g=i[8];var p;i[9]!==l||i[10]!==m||i[11]!==o||i[12]!==a?(p=[l,a,o,m],i[9]=l,i[10]=m,i[11]=o,i[12]=a,i[13]=p):p=i[13];a=d("ReQLSuspense").useArray(g,p,f.id+":167");i[14]!==a||i[15]!==j||i[16]!==b||i[17]!==m?(g=[a,j,m,b],i[14]=a,i[15]=j,i[16]=b,i[17]=m,i[18]=g):g=i[18];return g}function p(a){var b=a.attachmentType;a=a.defaultCtaType;return(i||(i=d("I64"))).equal(b,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))?a==="xma_web_url":!1}function b(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").LINKS),e[0]=f):f=e[0];a=o(a,f,p,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").LINKS),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function q(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function e(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),e[0]=f):f=e[0];a=o(a,f,q,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function r(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE))}function s(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),e[0]=f):f=e[0];a=o(a,f,r,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function t(a,b){var e,g=d("react-compiler-runtime").c(17),j=(h||(h=c("useReStore")))(),k;g[0]!==j.tables.attachments_ranges_v2__generated||g[1]!==b||g[2]!==a?(k=function(){return d("ReQL").fromTableDescending(j.tables.attachments_ranges_v2__generated).getKeyRange(a).filter(function(a){return(i||(i=d("I64"))).equal(a.mediaGroup,b)})},g[0]=j.tables.attachments_ranges_v2__generated,g[1]=b,g[2]=a,g[3]=k):k=g[3];var l;g[4]!==j||g[5]!==b||g[6]!==a?(l=[j,a,b],g[4]=j,g[5]=b,g[6]=a,g[7]=l):l=g[7];k=d("ReQLSuspense").useFirst(k,l,f.id+":291");l=k==null?void 0:k.minTimestampMs;e=c("gkx")("2616")===!0?k==null?void 0:k.hasMoreBefore:(e=k==null?void 0:k.hasMoreBefore)!=null?e:!1;if(g[8]!==j.tables.attachments||g[9]!==l||g[10]!==a){var m=d("ReQL").fromTableDescending(j.tables.attachments.index("fk_messages")).getKeyRange(a);m=l!=null&&(i||(i=d("I64"))).to_float(l)!==Number.MAX_SAFE_INTEGER&&c("gkx")("5318")===!0?m.bounds({gte:d("ReQL").key(l)}):m;g[8]=j.tables.attachments;g[9]=l;g[10]=a;g[11]=m}else m=g[11];m=m;var n;g[12]!==k||g[13]!==e||g[14]!==l||g[15]!==m?(n={attachmentsRange:k,hasMoreBefore:e,minTimestampMs:l,query:m},g[12]=k,g[13]=e,g[14]=l,g[15]=m,g[16]=n):n=g[16];return n}g.useLoader=a;g.useQueryLinkAttachments=b;g.filterMediaAttachments=q;g.useQueryMediaAttachments=e;g.useQueryFileAttachments=s;g.useAttachmentsQuery=t}),98);
__d("MWV2MediaViewerControls.react",["fbt","ix","FDSCircleButton.react","Int64Hooks","LSMessagingThreadTypeUtil","MDSRow.react","MDSRowItem.react","MWChatForwardCircleButton.react","MWV2MediaViewerContext.react","MWXTooltip.react","fbicon","react","react-compiler-runtime","useMWHasForwardAction","useMWV2MessageForwardAction"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k=j||(j=d("react")),l=j.useContext,m=h._(/*BTDS*/"__JHASH__yVgFxyhzJWR__JHASH__");function a(a){var b=d("react-compiler-runtime").c(15),e=a.attachment,f=a.message,g=a.onClose;a=a.thread;var j=l(d("MWV2MediaViewerContext.react").context),o;b[0]!==e||b[1]!==j?(o=j.getDownloadUrl(e,"MWV2MediaViewerControls"),b[0]=e,b[1]=j,b[2]=o):o=b[2];j=o;b[3]!==j?(o=j!=null?k.jsx(c("MDSRowItem.react"),{children:k.jsx(c("MWXTooltip.react"),{tooltip:m,children:k.jsx(c("FDSCircleButton.react"),{color_DEPRECATED:"white",icon:d("fbicon")._(i("1873235"),16),label:m,linkProps:{download:!0,target:"_blank",url:j},size:36,type_DEPRECATED:"dark-overlay"})})}):null,b[3]=j,b[4]=o):o=b[4];b[5]!==e||b[6]!==f||b[7]!==a?(j=f!=null?k.jsx(n,{attachment:e,message:f,thread:a}):null,b[5]=e,b[6]=f,b[7]=a,b[8]=j):j=b[8];b[9]!==g?(e=g!=null?k.jsx(c("MDSRowItem.react"),{children:k.jsx(c("FDSCircleButton.react"),{color_DEPRECATED:"white",icon:d("fbicon")._(i("478232"),16),label:h._(/*BTDS*/"__JHASH__gaxHiFwvIGk__JHASH__"),onPress:g,size:36,type_DEPRECATED:"dark-overlay"})}):null,b[9]=g,b[10]=e):e=b[10];b[11]!==o||b[12]!==j||b[13]!==e?(f=k.jsxs(c("MDSRow.react"),{paddingTop:0,spacing:8,children:[o,j,e]}),b[11]=o,b[12]=j,b[13]=e,b[14]=f):f=b[14];return f}function n(a){var b=d("react-compiler-runtime").c(9),e=a.attachment,f=a.message,g=a.thread;a=e==null?void 0:e.attachmentFbid;var i;b[0]!==g.threadType?(i=d("LSMessagingThreadTypeUtil").isArmadilloSecure(g.threadType),b[0]=g.threadType,b[1]=i):i=b[1];i=i;var j,l;b[2]!==g.threadType?(j=function(){return g.threadType},l=[g.threadType],b[2]=g.threadType,b[3]=j,b[4]=l):(j=b[3],l=b[4]);j=d("Int64Hooks").useMemoInt64(j,l);l=c("useMWV2MessageForwardAction")(i,f,j);i=c("useMWHasForwardAction")(g.threadType,f,e);j=i.shouldShowForwardAction;if(a==null||!j)return null;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(f=h._(/*BTDS*/"__JHASH__GvPr2MwluxY__JHASH__"),b[5]=f):f=b[5];b[6]!==a||b[7]!==l?(e=k.jsx(c("MDSRowItem.react"),{children:k.jsx(c("MWXTooltip.react"),{tooltip:f,children:k.jsx(c("MWChatForwardCircleButton.react"),{attachmentID:a,color:"white",onOpenForwardDialog:l,type:"dark_overlay"})})}),b[6]=a,b[7]=l,b[8]=e):e=b[8];return e}g["default"]=a}),226);
__d("MWV2MediaViewerItemImage.react",["MWV2MediaViewerContext.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.useEffect,l=b.useRef;function a(a){var b=d("react-compiler-runtime").c(20),c=a.attachment,e=a.mediaRenderQpl;a=j(d("MWV2MediaViewerContext.react").context);var f=a.getPlayableUrl;a=a.heroLoggingComponent;var g=l(null),h,m;b[0]!==e?(h=function(){var a;g.current!=null&&((a=g.current)==null?void 0:a.complete)&&e.endSuccess()},m=[e],b[0]=e,b[1]=h,b[2]=m):(h=b[1],m=b[2]);k(h,m);b[3]!==c||b[4]!==f||b[5]!==e?(h=f(c,"MediaViewerImage",e),b[3]=c,b[4]=f,b[5]=e,b[6]=h):h=b[6];m=h;if(m!=null){b[7]!==a?(c=a("MWV2MediaViewerImage"),b[7]=a,b[8]=c):c=b[8];b[9]===Symbol["for"]("react.memo_cache_sentinel")?(f={className:"xr1yuqi xkrivgy x4ii5y1 x1gryazu xmz0i5r x193iq5w x1ja2u2z"},b[9]=f):f=b[9];b[10]!==e?(h=function(){e.endFail("load-image-error")},a=function(){e.endSuccess()},b[10]=e,b[11]=h,b[12]=a):(h=b[11],a=b[12]);b[13]!==m||b[14]!==h||b[15]!==a?(f=i.jsx("img",babelHelpers["extends"]({},f,{onError:h,onLoad:a,ref:g,src:m})),b[13]=m,b[14]=h,b[15]=a,b[16]=f):f=b[16];b[17]!==c||b[18]!==f?(m=i.jsxs(i.Fragment,{children:[c,f]}),b[17]=c,b[18]=f,b[19]=m):m=b[19];return m}else{e.endFail("missing-playable-url");return null}}g["default"]=a}),98);
__d("MWV2MediaViewerItemVideo.react",["MWChatVideoPlayer.react","MWV2MediaViewerContext.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useContext;function a(a){var b=d("react-compiler-runtime").c(9),e=a.attachment;a=a.mediaRenderQpl;var f=j(d("MWV2MediaViewerContext.react").context);f=f.getPlayableUrl;var g;b[0]!==e||b[1]!==f||b[2]!==a?(g=f(e,"MediaViewerVideo",a),b[0]=e,b[1]=f,b[2]=a,b[3]=g):g=b[3];f=g;if(f!=null){b[4]===Symbol["for"]("react.memo_cache_sentinel")?(g={className:"x78zum5 x1iyjqo2 xmz0i5r"},b[4]=g):g=b[4];b[5]!==e.attachmentFbid||b[6]!==a||b[7]!==f?(g=i.jsx("div",babelHelpers["extends"]({},g,{children:i.jsx(c("MWChatVideoPlayer.react"),{controls:"mwchat",fbid:e.attachmentFbid,hideExpandButton:!1,isMediaViewer:!0,mediaRenderQpl:a,originalHeight:1e3,originalWidth:1e3,sdSrc:f,shouldForcePauseOnClick:!1})})),b[5]=e.attachmentFbid,b[6]=a,b[7]=f,b[8]=g):g=b[8];return g}else{a.endFail("missing-playable-url");return null}}g["default"]=a}),98);
__d("MWV2MediaViewerNullState.react",["fbt","CometColumn.react","CometColumnItem.react","FDSNullState.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=d("react-compiler-runtime").c(1),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=j.jsx(c("CometColumn.react"),{expanding:!0,verticalAlign:"center",children:j.jsx(c("CometColumnItem.react"),{children:j.jsx(c("FDSNullState.react"),{headline:h._(/*BTDS*/"__JHASH__f1n8ff4Nrlh__JHASH__")})})}),a[0]=b):b=a[0];return b}g["default"]=a}),226);
__d("MWV2MediaViewerItem.react",["I64","LSIntEnum","MWMediaViewerRenderQpl","MWV2MediaViewerItemImage.react","MWV2MediaViewerItemVideo.react","MWV2MediaViewerNullState.react","MessagingAttachmentType","gkx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=h||d("react");function a(a){var b=d("react-compiler-runtime").c(10),e=a.attachment,f=a.onClose;a=a.threadType;if(e==null){var g;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(g=k.jsx(c("MWV2MediaViewerNullState.react"),{}),b[0]=g):g=b[0];return g}g=e.attachmentType;if(!((i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))||(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)))){b[1]===Symbol["for"]("react.memo_cache_sentinel")?(g=k.jsx(c("MWV2MediaViewerNullState.react"),{}),b[1]=g):g=b[1];return g}b[2]!==f?(g=c("gkx")("6691")&&k.jsx("div",babelHelpers["extends"]({"aria-hidden":!0},{className:"x1ey2m1c xds687c x17qophe x10l6tqk x13vifvy"},{"data-testid":void 0,onClick:f})),b[2]=f,b[3]=g):g=b[3];b[4]!==e||b[5]!==a?(f=k.jsx(l,{attachment:e,threadType:a}),b[4]=e,b[5]=a,b[6]=f):f=b[6];b[7]!==g||b[8]!==f?(e=k.jsxs(k.Fragment,{children:[g,f]}),b[7]=g,b[8]=f,b[9]=e):e=b[9];return e}function l(a){var b=d("react-compiler-runtime").c(4),e=a.attachment;a=a.threadType;a=d("MWMediaViewerRenderQpl").useMediaViewerRenderQpl(e,a);var f=e.attachmentType,g;b[0]!==e||b[1]!==a||b[2]!==f?(g=(i||(i=d("I64"))).equal(f,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(f,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?k.jsx(c("MWV2MediaViewerItemImage.react"),{attachment:e,mediaRenderQpl:a}):(i||(i=d("I64"))).equal(f,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))?k.jsx(c("MWV2MediaViewerItemVideo.react"),{attachment:e,mediaRenderQpl:a}):null,b[0]=e,b[1]=a,b[2]=f,b[3]=g):g=b[3];return g}g["default"]=a}),98);
__d("MWV2MediaViewerContent.react",["fbt","CometHideLayerOnEscape.react","CometPlaceholder.react","FDSBlurredBackgroundImage.react","I64","LSIntEnum","MWChatAttachmentMediaNavigationHotkeys.react","MWChatAttachmentMediaState.react","MWChatAttachmentMediaThumbnails.react","MWChatMediaViewerNavigationTapTarget.react","MWFocusTable.react","MWV2MediaViewerContainer.react","MWV2MediaViewerContext.react","MWV2MediaViewerControls.react","MWV2MediaViewerControlsFallback.react","MWV2MediaViewerItem.react","MWXColumn.react","MWXColumnItem.react","MWXRow.react","MWXRowItem.react","MessagingAttachmentType","ReQL","ReQLSuspense","XPlatReactFocusRegion.react","gkx","justknobx","react","react-compiler-runtime","useReStore","useShouldShowPlaybackErrorFallback","useShouldShowUnsupportedCodecFallback"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=j||(j=d("react"));b=j;var n=b.useContext,o=b.useEffect,p={mediaItem:{marginTop:"x14vqqas",marginEnd:"xq8finb",marginBottom:"xod5an3",marginStart:"x16n37ib",$$css:!0},mediaRow:{minHeight:"x2lwn1j",$$css:!0},noOverflow:{maxWidth:"x193iq5w",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0}};function q(a){var b=d("react-compiler-runtime").c(6);a=a.attachment;var e=n(d("MWV2MediaViewerContext.react").context);e=e.getPreviewUrl;var f;b[0]!==a||b[1]!==e?(f=e(a,"BlurredBackground"),b[0]=a,b[1]=e,b[2]=f):f=b[2];e=f;if(e!=null&&a!=null&&!(k||(k=d("I64"))).equal(a.attachmentType,(l||(l=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))){b[3]===Symbol["for"]("react.memo_cache_sentinel")?(f={className:"x1ey2m1c xds687c x17qophe xuzhngd x10l6tqk x13vifvy"},b[3]=f):f=b[3];b[4]!==e?(a=m.jsx("div",babelHelpers["extends"]({},f,{children:m.jsx(c("FDSBlurredBackgroundImage.react"),{src:e})})),b[4]=e,b[5]=a):a=b[5];return a}else return null}function a(a){var b=d("react-compiler-runtime").c(75),e=a.initialAttachment,g=a.onClose,j=a.shouldShowMessengerLogo;a=a.thread;var k=n(d("MWChatAttachmentMediaState.react").context),l=k.canMoveBackward,r=k.canMoveForward,s=k.card,t=k.currentIndex,u=k.moveBackward,v=k.moveForward,w=k.numberOfCards;k=k.shouldTriggerLoadMore;var x=n(d("MWV2MediaViewerContext.react").context),y=x.getPreviewUrl,z=x.loadMore,A=(i||(i=c("useReStore")))(),B=e==null?void 0:e.threadKey,C=e==null?void 0:e.messageId;b[0]!==A.tables.attachments||b[1]!==C||b[2]!==B?(x=function(){return d("ReQL").fromTableDescending(A.tables.attachments).getKeyRange(B,C)},b[0]=A.tables.attachments,b[1]=C,b[2]=B,b[3]=x):x=b[3];var D;b[4]!==A||b[5]!==C||b[6]!==B?(D=[A,C,B],b[4]=A,b[5]=C,b[6]=B,b[7]=D):D=b[7];x=d("ReQLSuspense").useFirst(x,D,f.id+":113")!=null;var E=s!=null?s.attachment:x?e:void 0;b[8]!==E||b[9]!==A.tables.messages?(D=function(){return(E==null?void 0:E.messageId)==null?d("ReQL").empty():d("ReQL").fromTableAscending(A.tables.messages.index("messageId")).getKeyRange(E.messageId)},b[8]=E,b[9]=A.tables.messages,b[10]=D):D=b[10];s=E==null?void 0:E.messageId;b[11]!==A.tables.messages||b[12]!==s?(x=[s,A.tables.messages],b[11]=A.tables.messages,b[12]=s,b[13]=x):x=b[13];e=d("ReQLSuspense").useFirst(D,x,f.id+":129");b[14]!==t||b[15]!==w||b[16]!==k?(s=c("justknobx")._("1571")?k:t>w-5,b[14]=t,b[15]=w,b[16]=k,b[17]=s):s=b[17];var F=s;b[18]!==z||b[19]!==F?(D=function(){F&&z()},x=[F,z],b[18]=z,b[19]=F,b[20]=D,b[21]=x):(D=b[20],x=b[21]);o(D,x);t=c("gkx")("1775");w=c("useShouldShowUnsupportedCodecFallback")(E);k=c("useShouldShowPlaybackErrorFallback")(E);b[22]!==E||b[23]!==k||b[24]!==w||b[25]!==g||b[26]!==a?(s=!w&&!k?m.jsx(c("MWV2MediaViewerItem.react"),{attachment:E,onClose:g,threadType:a.threadType}):null,b[22]=E,b[23]=k,b[24]=w,b[25]=g,b[26]=a,b[27]=s):s=b[27];D=s;b[28]===Symbol["for"]("react.memo_cache_sentinel")?(x=c("justknobx")._("3491"),b[28]=x):x=b[28];k=x;b[29]!==g?(w=g!=null?m.jsx(c("MWV2MediaViewerControlsFallback.react"),{onClose:g}):null,b[29]=g,b[30]=w):w=b[30];b[31]!==E||b[32]!==e||b[33]!==g||b[34]!==a?(s=m.jsx(c("MWV2MediaViewerControls.react"),{attachment:E,message:e,onClose:g,thread:a}),b[31]=E,b[32]=e,b[33]=g,b[34]=a,b[35]=s):s=b[35];b[36]!==w||b[37]!==s?(x=m.jsx(c("CometPlaceholder.react"),{fallback:w,name:"MWV2MediaViewerContent.Controls",children:s}),b[36]=w,b[37]=s,b[38]=x):x=b[38];b[39]!==g?(e=k?null:m.jsx(d("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{onClose:t?g:void 0}),b[39]=g,b[40]=e):e=b[40];b[41]!==E?(a=m.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWV2MediaViewerContent.BlurredBackground",children:m.jsx(q,{attachment:E})}),b[41]=E,b[42]=a):a=b[42];b[43]===Symbol["for"]("react.memo_cache_sentinel")?(w=[p.mediaRow,t&&p.noOverflow],b[43]=w):w=b[43];s=!l;b[44]===Symbol["for"]("react.memo_cache_sentinel")?(l=h._(/*BTDS*/"__JHASH__LwpPfoJWBJ-__JHASH__"),b[44]=l):l=b[44];b[45]!==u||b[46]!==s?(l=m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"previous",invisible:s,label:l,onClick:u,testid:void 0})}),b[45]=u,b[46]=s,b[47]=l):l=b[47];b[48]!==D?(u=m.jsx(c("MWXRowItem.react"),{expanding:!0,verticalAlign:"stretch",xstyle:t&&p.mediaItem,children:m.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWV2MediaViewerContent.MediaContent",children:D})}),b[48]=D,b[49]=u):u=b[49];s=!r;b[50]===Symbol["for"]("react.memo_cache_sentinel")?(D=h._(/*BTDS*/"__JHASH__37s-bUHecpV__JHASH__"),b[50]=D):D=b[50];b[51]!==v||b[52]!==s?(r=m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"next",invisible:s,label:D,onClick:v,testid:void 0})}),b[51]=v,b[52]=s,b[53]=r):r=b[53];b[54]!==l||b[55]!==u||b[56]!==r?(D=m.jsx(c("MWXColumnItem.react"),{expanding:!0,verticalAlign:"center",children:m.jsxs(c("MWXRow.react"),{align:"justify",expanding:!0,paddingHorizontal:0,paddingVertical:0,spacingHorizontal:t?0:void 0,verticalAlign:"stretch",xstyle:w,children:[l,u,r]})}),b[54]=l,b[55]=u,b[56]=r,b[57]=D):D=b[57];b[58]!==y?(v=m.jsx(c("MWXColumnItem.react"),{children:m.jsx(c("XPlatReactFocusRegion.react"),{autoFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,autoRestoreFocus:!0,children:m.jsx(c("MWChatAttachmentMediaThumbnails.react"),{getPreviewUrl:y})})}),b[58]=y,b[59]=v):v=b[59];b[60]!==D||b[61]!==v?(s=m.jsxs(c("MWXColumn.react"),{align:"stretch",expanding:!0,paddingHorizontal:0,verticalAlign:"space-between",children:[D,v]}),b[60]=D,b[61]=v,b[62]=s):s=b[62];b[63]!==j||b[64]!==x||b[65]!==e||b[66]!==a||b[67]!==s?(w=m.jsxs(c("MWV2MediaViewerContainer.react"),{actions:x,shouldShowMessengerLogo:j,children:[e,a,s]}),b[63]=j,b[64]=x,b[65]=e,b[66]=a,b[67]=s,b[68]=w):w=b[68];l=w;if(g!=null&&!t){b[69]!==l||b[70]!==g?(u=m.jsx(c("CometHideLayerOnEscape.react"),{onHide:g,children:l}),b[69]=l,b[70]=g,b[71]=u):u=b[71];return u}else{if(k){r=t?g:void 0;b[72]!==l||b[73]!==r?(y=m.jsx(d("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{onClose:r,children:l}),b[72]=l,b[73]=r,b[74]=y):y=b[74];return y}return l}}g["default"]=a}),226);
__d("useLoadMoreThreadSharedAttachments.react",["Int64Hooks","LSFactory","LSIssueAttachmentsRangeQueryStoredProcedure","MAWThreadCutover","MWThreadKey.react","gkx","promiseDone","react-compiler-runtime","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){var g=d("react-compiler-runtime").c(6),h=c("useAsyncReStore")(),i=d("MWThreadKey.react").useMWThreadKeyMemoized();i==null&&(i=b);b=d("MAWThreadCutover").useGetCutoverOpenThreadKey(i);var j=b&&c("gkx")("2616")===!0?b:i;g[0]!==h||g[1]!==j||g[2]!==e||g[3]!==a?(b=function(){e==null?void 0:e(),c("promiseDone")(h,function(b){return b.runInTransaction(function(b){return c("LSIssueAttachmentsRangeQueryStoredProcedure")(c("LSFactory")(b),{mediaGroup:a,threadKey:j})},"readwrite",void 0,void 0,f.id+":45")})},i=[e,h,a,j],g[0]=h,g[1]=j,g[2]=e,g[3]=a,g[4]=b,g[5]=i):(b=g[4],i=g[5]);return d("Int64Hooks").useCallbackInt64(b,i)}g["default"]=a}),98);
__d("useMAWLoadMoreThreadSharedAttachments",["I64","Int64Hooks","MAWBridgeSendAndReceive","MAWMiActOnActThreadReady","gkx","promiseDone","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(i||(i=d("I64"))).of_string("9999999999999");function a(a,b,e,f,g,k,l){var m=d("react-compiler-runtime").c(13),n=(h||(h=c("useReStore")))(),o,p;m[0]!==b||m[1]!==e?(o=function(){return b!=null&&b&&e!=null?c("gkx")("2616")===!0?(i||(i=d("I64"))).to_float(e):(i||(i=d("I64"))).to_int32(e):c("gkx")("2616")===!0?Number.MAX_SAFE_INTEGER:(i||(i=d("I64"))).to_int32(j)},p=[b,e],m[0]=b,m[1]=e,m[2]=o,m[3]=p):(o=m[2],p=m[3]);var q=d("Int64Hooks").useCallbackInt64(o,p);m[4]!==n.tables||m[5]!==f||m[6]!==q||m[7]!==g||m[8]!==k||m[9]!==l||m[10]!==a?(o=function(){a!=null&&(g==null?void 0:g(),c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(n.tables,a,"useMAWLoadMoreThreadSharedAttachments",function(a,b){return d("MAWBridgeSendAndReceive").sendAndReceive("backend","loadMoreMedia",{earliestLoadedMediaMessageId:f,earliestLoadedMediaTs:q(),mediaGalleryGroup:c("gkx")("1338")===!0?k:void 0,pageSize:l,threadJid:b})})))},p=[a,g,n.tables,f,q,k,l],m[4]=n.tables,m[5]=f,m[6]=q,m[7]=g,m[8]=k,m[9]=l,m[10]=a,m[11]=o,m[12]=p):(o=m[11],p=m[12]);return d("Int64Hooks").useCallbackInt64(o,p)}g["default"]=a}),98);
__d("useMAWQuerySecureMediaAttachments",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MWSharedAttachmentsSectionHooks","ReQL","ReQLSuspense","gkx","justknobx","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;b=k||d("react");var l=b.useCallback,m=b.useMemo,n=c("justknobx")._("1132");function a(a,b){b=b===void 0?{}:b;b=b.removeUnsentMessages;var e=b===void 0?!1:b,g=(h||(h=c("useReStore")))();b=d("MWSharedAttachmentsSectionHooks").useAttachmentsQuery(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS));var k=b.attachmentsRange,p=b.hasMoreBefore,r=b.minTimestampMs,s=b.query,t=l(function(a){if(!d("MWSharedAttachmentsSectionHooks").filterMediaAttachments(a))return null;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(g.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":76");if(e&&(b==null||b.isUnsent))return null;return c("gkx")("5318")===!0?b==null?{attachment:a}:{attachment:a,message:b}:{attachment:a}},[g,e]),u=d("ReQLSuspense").useArray(function(){if(c("gkx")("1338")===!0){var a=s.map(t).filter(Boolean);(r==null||(j||(j=d("I64"))).equal(r,(j||(j=d("I64"))).zero))&&(a=a.take(n));return a}else return s.map(t).filter(Boolean)},[g,a,t,r],f.id+":98"),v=m(function(){var a=o(u);c("gkx")("5318")===!0&&a.sort(q);return a},[u]);b=m(function(){return v.map(function(a){a=a.attachment;return a})},[v]);return[b,i.ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),k,r,p]}function o(a){var b=p(a);return a.map(function(a){var c,e=a.attachment;a=a.message;var f=a==null?void 0:a.groupId;c=b.get((c=f)!=null?c:"");if(f==null||c==null){return{attachment:e,message:a,sortKey:{sortingMessageGroupIndex:Number.MAX_SAFE_INTEGER,sortingMessageId:e.messageId,sortingMessagePrimarySortTS:(f=a==null?void 0:a.primarySortKey)!=null?f:e.timestampMs,sortingMessageSecondarySortTS:(f=(f=a==null?void 0:a.secondarySortKey)!=null?f:a==null?void 0:a.timestampMs)!=null?f:e.timestampMs}}}return{attachment:e,message:a,sortKey:{sortingMessageGroupIndex:(j||(j=d("I64"))).to_int32((f=a==null?void 0:a.groupIndex)!=null?f:(j||(j=d("I64"))).zero),sortingMessageId:c.messageId,sortingMessagePrimarySortTS:c.primarySortTs,sortingMessageSecondarySortTS:c.secondarySortTs}}})}function p(a){var b=new Map();a.forEach(function(a){var c;a=a.message;if(!a||a.groupId==null||a.groupIndex==null)return;var e=a.groupId,f=(j||(j=d("I64"))).to_int32(a.groupIndex);c=Math.min((c=(c=b.get(e))==null?void 0:c.groupIndex)!=null?c:Number.MAX_SAFE_INTEGER,f);f=f===c?{groupIndex:f,messageId:a.messageId,primarySortTs:a.primarySortKey,secondarySortTs:(c=a.secondarySortKey)!=null?c:a.timestampMs}:b.get(e);f&&b.set(e,f)});return b}function q(a,b){var c=a.sortKey,e=b.sortKey;a=a.message;b=b.message;if(!(j||(j=d("I64"))).equal(c.sortingMessagePrimarySortTS,e.sortingMessagePrimarySortTS))return(j||(j=d("I64"))).compare(e.sortingMessagePrimarySortTS,c.sortingMessagePrimarySortTS);if(!(j||(j=d("I64"))).equal(e.sortingMessageSecondarySortTS,c.sortingMessageSecondarySortTS))return(j||(j=d("I64"))).compare(e.sortingMessageSecondarySortTS,c.sortingMessageSecondarySortTS);if(c.sortingMessageId!==e.sortingMessageId)return e.sortingMessageId.localeCompare(c.sortingMessageId);return(a==null?void 0:a.groupId)!=null&&(b==null?void 0:b.groupId)!=null&&a.groupId===b.groupId?e.sortingMessageGroupIndex-c.sortingMessageGroupIndex:0}g["default"]=a}),98);
__d("useMWMediaLoadingQplLogger",["MWMediaRenderQplUtils","QPLUserFlow","QuickPerformanceLogger","Random","gkx","qpl","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=i||d("react");b.useCallback;var j=b.useEffect;b.useMemo;function a(a){var b=d("react-compiler-runtime").c(10),e=a.entrypoint,f=a.threadType;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=n(),b[0]=a):a=b[0];a=a;var g=a;b[1]!==e||b[2]!==f?(a=function(a){var b;if(!c("gkx")("2616"))return;k({entrypoint:e,instanceKey:g,isCutoverThread:(b=a==null?void 0:a.isCutoverThread)!=null?b:!1,isPreCutoverMedia:(b=a==null?void 0:a.isPreCutoverMedia)!=null?b:!1,threadType:f})},b[1]=e,b[2]=f,b[3]=a):a=b[3];a=a;var i;b[4]===Symbol["for"]("react.memo_cache_sentinel")?(i=function(a){var b=a.fetchedMediaCount,d=a.isAlreadyPreloaded;a=a.startMediaCount;if(!c("gkx")("2616"))return;l({fetchedMediaCount:b,instanceKey:g,isAlreadyPreloaded:d,startMediaCount:a})},b[4]=i):i=b[4];i=i;var o;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(o=function(){if(!c("gkx")("2616"))return;m({instanceKey:g})},b[5]=o):o=b[5];var p=o,q;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(o=function(){return function(){var a=(h||(h=c("QuickPerformanceLogger"))).isMarkerOn(c("qpl")._(25300395,"1954"),g);a&&p()}},q=[g,p],b[6]=o,b[7]=q):(o=b[6],q=b[7]);j(o,q);b[8]!==a?(o={logLoadMediaCancel:p,logLoadMediaStart:a,logLoadMediaSuccess:i},b[8]=a,b[9]=o):o=b[9];q=o;return q}function k(a){var b=a.entrypoint,e=a.instanceKey,f=a.isCutoverThread;f=f===void 0?!1:f;var g=a.isPreCutoverMedia;g=g===void 0?!1:g;a=a.threadType;c("QPLUserFlow").start(c("qpl")._(25300395,"1954"),{annotations:{bool:{isCutoverThread:f,isPreCutoverMedia:g},string:{entrypoint:b,threadType:d("MWMediaRenderQplUtils").getThreadTypeStringFromEnum(a)}},cancelOnUnload:!0,instanceKey:e,timeoutInMs:60*1e3})}function l(a){var b=a.fetchedMediaCount,d=a.instanceKey,e=a.isAlreadyPreloaded;a=a.startMediaCount;c("QPLUserFlow").endSuccess(c("qpl")._(25300395,"1954"),{annotations:{bool:{isAlreadyPreloaded:(e=e)!=null?e:!1},"int":{fetchedMediaCount:b,startMediaCount:a}},instanceKey:d})}function m(a){a=a.instanceKey;c("QPLUserFlow").endCancel(c("qpl")._(25300395,"1954"),{instanceKey:a})}function n(){return Date.now()+Math.round(d("Random").random()*1e4)}g["default"]=a}),98);
__d("useMAWLoadMoreCutoverThreadSharedAttachments",["MAWDbMsg","MWSharedAttachmentsSectionHooks","gkx","justknobx","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMAWLoadMoreThreadSharedAttachments","useMAWQuerySecureMediaAttachments","useMWMediaLoadingQplLogger"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(a,b,e,f,g,h,j){var k,l=d("react-compiler-runtime").c(45),m=c("useMAWQuerySecureMediaAttachments")(a),n=m[0],o=m[1],p=m[2],q=m[3];m=m[4];var r;l[0]!==(p==null?void 0:p.lastLoadedMessageId)?(r=(p==null?void 0:p.lastLoadedMessageId)!=null?d("MAWDbMsg").toMsgId(p==null?void 0:p.lastLoadedMessageId):void 0,l[0]=p==null?void 0:p.lastLoadedMessageId,l[1]=r):r=l[1];r=r;k=(k=m)!=null?k:!0;var s;l[2]!==f.entrypoint||l[3]!==e?(s={entrypoint:f.entrypoint,threadType:e},l[2]=f.entrypoint,l[3]=e,l[4]=s):s=l[4];var t=c("useMWMediaLoadingQplLogger")(s);l[5]!==t?(f=function(){t.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!1})},l[5]=t,l[6]=f):f=l[6];e=f;f=c("useMAWLoadMoreThreadSharedAttachments")(a,m,q,(s=r)!=null?s:void 0,e,g,j);a=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(b);m=a[0];q=a[2];r=a[4];l[7]===Symbol["for"]("react.memo_cache_sentinel")?(s=c("justknobx")._("2968"),l[7]=s):s=l[7];e=s;j=((g=r)!=null?g:c("gkx")("6241"))?e:!1;l[8]!==t?(a=function(){t.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!0})},l[8]=t,l[9]=a):a=l[9];s=a;r=c("useLoadMoreThreadSharedAttachments.react")(o,b,s);l[10]!==p||l[11]!==k||l[12]!==f||l[13]!==n||l[14]!==t.logLoadMediaCancel||l[15]!==t.logLoadMediaSuccess?(g={attachmentsRange:p,hasMore:k,loadMore:f,logLoadMediaCancel:t.logLoadMediaCancel,logLoadMediaSuccess:t.logLoadMediaSuccess,media:n},l[10]=p,l[11]=k,l[12]=f,l[13]=n,l[14]=t.logLoadMediaCancel,l[15]=t.logLoadMediaSuccess,l[16]=g):g=l[16];e=d("MWSharedAttachmentsSectionHooks").useLoader(g);a=e[0];o=e[1];b=e[2];s=k||a;l[17]!==q||l[18]!==j||l[19]!==r||l[20]!==m||l[21]!==t.logLoadMediaCancel||l[22]!==t.logLoadMediaSuccess||l[23]!==s?(p={attachmentsRange:q,hasMore:j,loadMore:r,logLoadMediaCancel:t.logLoadMediaCancel,logLoadMediaSuccess:t.logLoadMediaSuccess,media:m,skipInitialLoad:s},l[17]=q,l[18]=j,l[19]=r,l[20]=m,l[21]=t.logLoadMediaCancel,l[22]=t.logLoadMediaSuccess,l[23]=s,l[24]=p):p=l[24];f=d("MWSharedAttachmentsSectionHooks").useLoader(p);g=f[0];e=f[1];q=f[2];if(k||a||h===!0){l[25]!==b||l[26]!==k||l[27]!==a||l[28]!==n||l[29]!==o?(r={attachments:n,completedFirstLoad:b,hasMore:k,isLoadingMore:a,onLoadMore:o},l[25]=b,l[26]=k,l[27]=a,l[28]=n,l[29]=o,l[30]=r):r=l[30];return r}else if(j||g){l[31]!==m||l[32]!==n?(s=n.concat(m),l[31]=m,l[32]=n,l[33]=s):s=l[33];l[34]!==q||l[35]!==j||l[36]!==g||l[37]!==e||l[38]!==s?(p={attachments:s,completedFirstLoad:q,hasMore:j,isLoadingMore:g,onLoadMore:e},l[34]=q,l[35]=j,l[36]=g,l[37]=e,l[38]=s,l[39]=p):p=l[39];return p}else{l[40]!==m||l[41]!==n?(f=n.concat(m),l[40]=m,l[41]=n,l[42]=f):f=l[42];l[43]!==f?(h={attachments:f,completedFirstLoad:!0,hasMore:!1,isLoadingMore:!1,onLoadMore:i},l[43]=f,l[44]=h):h=l[44];return h}}function i(){}g["default"]=a}),98);
__d("useMWMediaGalleryRestoreStatus",["Int64Hooks","LSMessagingThreadTypeUtil","MAWFTSRestoreSync","MAWMiActOnActThreadReady","MWEBEntrypointsKillswitch.enum","MWInboxMessageSearchStatusTypes","Promise","asyncToGeneratorRuntime","cr:11999","justknobx","react","react-compiler-runtime","useMWEBBackupState","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=(j||d("react")).useState;function a(a){var e=d("react-compiler-runtime").c(9),f=a.threadKey;a=a.threadType;var g=(i||(i=c("useReStore")))(),j=k(null),n=j[0],o=j[1];e[0]===Symbol["for"]("react.memo_cache_sentinel")?(j={entrypoint:c("MWEBEntrypointsKillswitch.enum").MEDIA_GALLERY_RESTORE},e[0]=j):j=e[0];j=c("useMWEBBackupState")(j);var p=b("cr:11999")(n,"media");a=d("LSMessagingThreadTypeUtil").isArmadilloSecure(a);var q;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(q=d("MAWFTSRestoreSync").getMediaRestoreSync(),e[1]=q):q=e[1];var r=q;e[2]===Symbol["for"]("react.memo_cache_sentinel")?(q=function(){return r.isStarted()},e[2]=q):q=e[2];q=k(q);var s=q[0],t=q[1];e[3]===Symbol["for"]("react.memo_cache_sentinel")?(q=function(){return r.isEBMaybeAvailable()},e[3]=q):q=e[3];q=k(q);var u=q[0],v=q[1];e[4]===Symbol["for"]("react.memo_cache_sentinel")?(q=function(){return r.getActiveThreadId()},e[4]=q):q=e[4];q=k(q);var w=q[0],x=q[1];q=k(-1);var y=q[0],z=q[1];q=k(!1);var A=q[0],B=q[1],C;e[5]!==g.tables||e[6]!==f?(q=function(){var a;(a=d("MAWFTSRestoreSync")).MAWGalleryEventEmitter.addListener("isSyncStarted",function(a){return t(a)});a.MAWGalleryEventEmitter.addListener("isEBMaybeAvailable",function(a){return v(a)});a.MAWGalleryEventEmitter.addListener("activeThreadJid",function(a){return x(a)});a.MAWGalleryEventEmitter.addListener("isPersisting",function(a){return B(a)});a.MAWGalleryEventEmitter.addListener("restoredUntilMs",function(a){z(a)});a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield d("MAWMiActOnActThreadReady").onActThreadReady(g.tables,f,"useThreadJid",function(a,c){o(c);return(h||(h=b("Promise"))).resolve()})});function c(){return a.apply(this,arguments)}return c}();a()["catch"](m);return l},C=[g.tables,f],e[5]=g.tables,e[6]=f,e[7]=q,e[8]=C):(q=e[7],C=e[8]);d("Int64Hooks").useEffectInt64(q,C);if(n!=null&&r.getDoneThreads().has(n))return d("MWInboxMessageSearchStatusTypes").RestoreStatus.COMPLETE;e=n!=null&&w===n;if(!a)return d("MWInboxMessageSearchStatusTypes").RestoreStatus.NOT_REQUIRED;if(j!==3)return d("MWInboxMessageSearchStatusTypes").RestoreStatus.NOT_RUNNING;if(s){if(!u||!e)return d("MWInboxMessageSearchStatusTypes").RestoreStatus.NOT_RUNNING;q=c("justknobx")._("3245")?y===0:p===0;return q&&!A?d("MWInboxMessageSearchStatusTypes").RestoreStatus.COMPLETE:d("MWInboxMessageSearchStatusTypes").RestoreStatus.IN_PROGRESS}else return d("MWInboxMessageSearchStatusTypes").RestoreStatus.NOT_RUNNING}function l(){d("MAWFTSRestoreSync").MAWGalleryEventEmitter.removeAllListeners()}function m(){}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenPlayableUrl",["I64","LSIntEnum","LSMediaUrlAttachment","MessagingAttachmentType","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;(h||d("react")).useCallback;function a(){return k}function k(a){if(a==null)return;return(i||(i=d("I64"))).equal(a.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?d("LSMediaUrlAttachment").previewUrl(a):d("LSMediaUrlAttachment").playableUrl(a)}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenDownloadUrl",["gkx","react","react-compiler-runtime","useMWV2MediaViewerOpenPlayableUrl"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){var a=d("react-compiler-runtime").c(2),b=c("useMWV2MediaViewerOpenPlayableUrl")(),e;a[0]!==b?(e=function(a,d,e){a=b(a,d,e);if(a==null)return;if(!c("gkx")("3973"))return a;d=new URL(a);d.searchParams.set("dl","1");return d.toString()},a[0]=b,a[1]=e):e=a[1];return e}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenPreviewUrl",["LSMediaUrlAttachment","react"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a){return a!=null?d("LSMediaUrlAttachment").previewUrl(a):void 0}g["default"]=a}),98);
__d("useMWV2MediaViewerSecurePreviewUrl",["cr:5931","react"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a,c,d){return b("cr:5931")==null?void 0:b("cr:5931").getThumbnailBlob(a,c,d)}g["default"]=a}),98);
__d("MWV2MediaViewerCutoverWrapper.react",["LSThreadMediaGalleryGroup","MWChatAttachmentMediaState.react","MWInboxMessageSearchStatusTypes","MWV2MediaViewerContext.react","cr:1977","emptyFunction","justknobx","react","react-compiler-runtime","useMAWLoadMoreCutoverThreadSharedAttachments","useMWMediaGalleryRestoreStatus","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl","useMWV2MediaViewerSecurePlayableUrl","useMWV2MediaViewerSecurePreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){var e=d("react-compiler-runtime").c(30),f=a.children,g=a.initialAttachment,h=a.openThreadKey,k=a.secureThreadKey;a=a.threadType;var l;e[0]!==k||e[1]!==a?(l={threadKey:k,threadType:a},e[0]=k,e[1]=a,e[2]=l):l=e[2];b("cr:1977")(l);e[3]!==k||e[4]!==a?(l={threadKey:k,threadType:a},e[3]=k,e[4]=a,e[5]=l):l=e[5];l=c("useMWMediaGalleryRestoreStatus")(l);l=l===d("MWInboxMessageSearchStatusTypes").RestoreStatus.IN_PROGRESS;var m;e[6]===Symbol["for"]("react.memo_cache_sentinel")?(m={entrypoint:"media_viewer"},e[6]=m):m=e[6];var n;e[7]===Symbol["for"]("react.memo_cache_sentinel")?(n=c("justknobx")._("3233"),e[7]=n):n=e[7];k=c("useMAWLoadMoreCutoverThreadSharedAttachments")(k,h,a,m,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,l,n);h=k.attachments;a=k.onLoadMore;var o=j,p=c("useMWV2MediaViewerOpenPreviewUrl")(),q=c("useMWV2MediaViewerOpenPlayableUrl")(),r=c("useMWV2MediaViewerOpenDownloadUrl")(),s=c("useMWV2MediaViewerSecurePreviewUrl")(),t=c("useMWV2MediaViewerSecurePlayableUrl")();e[8]!==p||e[9]!==s?(m=function(a,b,c){if(!a)return"";return!o(a)?p(a,b,c):s(a,b,c)},e[8]=p,e[9]=s,e[10]=m):m=e[10];l=m;e[11]!==q||e[12]!==t?(n=function(a,b,c){if(a==null)return"";return!o(a)?q(a,b,c):t(a,b,c)},e[11]=q,e[12]=t,e[13]=n):n=e[13];k=n;e[14]!==r||e[15]!==t?(m=function(a,b,c){if(a==null)return"";return!o(a)?r(a,b,c):t(a,b,c)},e[14]=r,e[15]=t,e[16]=m):m=e[16];n=m;e[17]!==h||e[18]!==f||e[19]!==k||e[20]!==l||e[21]!==g?(m=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:h,getIsSecureThread:o,getPlayableUrl:k,getPreviewUrl:l,initialAttachment:g,children:f}),e[17]=h,e[18]=f,e[19]=k,e[20]=l,e[21]=g,e[22]=m):m=e[22];e[23]!==h||e[24]!==n||e[25]!==k||e[26]!==l||e[27]!==a||e[28]!==m?(f=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:n,getPlayableUrl:k,getPreviewUrl:l,heroLoggingComponent:c("emptyFunction"),loadMore:a,media:h,children:m}),e[23]=h,e[24]=n,e[25]=k,e[26]=l,e[27]=a,e[28]=m,e[29]=f):f=e[29];return f}function j(a){return!((a==null?void 0:a.transportKey)==="FBBroker"||(a==null?void 0:a.transportKey)==="FBLegacyBroker")}g["default"]=a}),98);
__d("MWV2MediaViewerOpenWrapper.react",["CometHero.react","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMWMediaLoadingQplLogger","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){var b=d("react-compiler-runtime").c(22),e=a.children,f=a.initialAttachment;a=a.thread;var g=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(a.threadKey),h=g[0],l=g[1],m=g[2];g=g[4];var n;b[0]!==a.threadType?(n={entrypoint:"media_viewer",threadType:a.threadType},b[0]=a.threadType,b[1]=n):n=b[1];n=c("useMWMediaLoadingQplLogger")(n);l=c("useLoadMoreThreadSharedAttachments.react")(l,a.threadKey,n.logLoadMediaStart);g=(a=g)!=null?a:!0;b[2]!==m||b[3]!==l||b[4]!==h||b[5]!==n.logLoadMediaCancel||b[6]!==n.logLoadMediaSuccess||b[7]!==g?(a={attachmentsRange:m,hasMore:g,loadMore:l,logLoadMediaCancel:n.logLoadMediaCancel,logLoadMediaSuccess:n.logLoadMediaSuccess,media:h},b[2]=m,b[3]=l,b[4]=h,b[5]=n.logLoadMediaCancel,b[6]=n.logLoadMediaSuccess,b[7]=g,b[8]=a):a=b[8];m=d("MWSharedAttachmentsSectionHooks").useLoader(a);l=m[1];n=c("useMWV2MediaViewerOpenPreviewUrl")();g=c("useMWV2MediaViewerOpenPlayableUrl")();a=c("useMWV2MediaViewerOpenDownloadUrl")();m=k;b[9]!==e||b[10]!==g||b[11]!==n||b[12]!==f||b[13]!==h?(m=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:h,getIsSecureThread:m,getPlayableUrl:g,getPreviewUrl:n,initialAttachment:f,children:e}),b[9]=e,b[10]=g,b[11]=n,b[12]=f,b[13]=h,b[14]=m):m=b[14];b[15]!==a||b[16]!==g||b[17]!==n||b[18]!==l||b[19]!==h||b[20]!==m?(e=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:a,getPlayableUrl:g,getPreviewUrl:n,heroLoggingComponent:j,loadMore:l,media:h,children:m}),b[15]=a,b[16]=g,b[17]=n,b[18]=l,b[19]=h,b[20]=m,b[21]=e):e=b[21];return e}function j(a){return i.jsx(c("CometHero.react"),{description:a})}j.displayName=j.name+" [from "+f.id+"]";function k(){return!1}g["default"]=a}),98);
__d("MWV2MediaViewerSecureWrapper.react",["LSThreadMediaGalleryGroup","MAWDbMsg","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","MWV2MediaViewerNullState.react","cr:1977","cr:5709","cr:5931","cr:5970","emptyFunction","gkx","justknobx","react","react-compiler-runtime","useMAWQuerySecureMediaAttachments","useMWMediaLoadingQplLogger","useMWV2MediaViewerSecurePlayableUrl","useMWV2MediaViewerSecurePreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a,b,c,d,e,f,g){return j}function j(){}var k=b("cr:5709")==null?a:b("cr:5709");function e(a){var e=d("react-compiler-runtime").c(28),f=a.children,g=a.initialAttachment;a=a.thread;var h=c("useMAWQuerySecureMediaAttachments")(a.threadKey),j=h[0],m=h[2],n=h[3];h=h[4];b("cr:1977")(a);var o=(h=h)!=null?h:!0;e[0]!==a.threadType?(h={entrypoint:"media_viewer",threadType:a.threadType},e[0]=a.threadType,e[1]=h):h=e[1];h=c("useMWMediaLoadingQplLogger")(h);a=a.threadKey;if(e[2]!==(m==null?void 0:m.lastLoadedMessageId)){var p;p=c("gkx")("2616")===!0?(p=d("MAWDbMsg").toMsgId((p=m==null?void 0:m.lastLoadedMessageId)!=null?p:""))!=null?p:void 0:void 0;e[2]=m==null?void 0:m.lastLoadedMessageId;e[3]=p}else p=e[3];var q=h.logLoadMediaStart,r;e[4]===Symbol["for"]("react.memo_cache_sentinel")?(r=c("justknobx")._("3233"),e[4]=r):r=e[4];var s=k(a,o,n,p,q,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,r);e[5]!==o||e[6]!==s?(a=function(){o&&s()},e[5]=o,e[6]=s,e[7]=a):a=e[7];n=a;e[8]!==m||e[9]!==o||e[10]!==n||e[11]!==j||e[12]!==h.logLoadMediaCancel||e[13]!==h.logLoadMediaSuccess?(p={attachmentsRange:m,hasMore:o,loadMore:n,logLoadMediaCancel:h.logLoadMediaCancel,logLoadMediaSuccess:h.logLoadMediaSuccess,media:j},e[8]=m,e[9]=o,e[10]=n,e[11]=j,e[12]=h.logLoadMediaCancel,e[13]=h.logLoadMediaSuccess,e[14]=p):p=e[14];q=d("MWSharedAttachmentsSectionHooks").useLoader(p);r=q[1];a=c("useMWV2MediaViewerSecurePreviewUrl")();m=c("useMWV2MediaViewerSecurePlayableUrl")();n=l;if(b("cr:5970")==null||b("cr:5931")==null){e[15]===Symbol["for"]("react.memo_cache_sentinel")?(h=i.jsx(c("MWV2MediaViewerNullState.react"),{}),e[15]=h):h=e[15];return h}e[16]!==f||e[17]!==m||e[18]!==a||e[19]!==g||e[20]!==j?(p=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:j,getIsSecureThread:n,getPlayableUrl:m,getPreviewUrl:a,initialAttachment:g,children:f}),e[16]=f,e[17]=m,e[18]=a,e[19]=g,e[20]=j,e[21]=p):p=e[21];e[22]!==m||e[23]!==a||e[24]!==r||e[25]!==j||e[26]!==p?(q=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:m,getPlayableUrl:m,getPreviewUrl:a,heroLoggingComponent:c("emptyFunction"),loadMore:r,media:j,children:p}),e[22]=m,e[23]=a,e[24]=r,e[25]=j,e[26]=p,e[27]=q):q=e[27];return q}function l(){return!0}g["default"]=e}),98);
__d("MWV2MediaViewer.react",["FBLogger","I64","LSMessagingThreadTypeUtil","MAWMediaGalleryM2Utils","MAWThreadCutover","MWLSThread","MWLSThreadDisplayContext","MWPThreadCapabilitiesContext","MWV2MediaViewerContent.react","MWV2MediaViewerCutoverWrapper.react","MWV2MediaViewerNullState.react","MWV2MediaViewerOpenWrapper.react","MWV2MediaViewerSecureWrapper.react","XPlatReactFocusRegion.react","cr:4482","gkx","justknobx","react","react-compiler-runtime","requireDeferred","useMWMediaViewerOpenQPLLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react"));e=h;e.useCallback;var k=e.useEffect,l=c("requireDeferred")("MAWFTSRestoreSync").__setRef("MWV2MediaViewer.react");function a(a){var e=d("react-compiler-runtime").c(63),f=a.attachment,g=a.onClose;a=a.shouldShowMessengerLogo;var h=d("useMWMediaViewerOpenQPLLogger").useMWMediaViewerOpenQPLLogger(),m=h.endSuccess,n;e[0]!==m?(h=function(){m()},n=[m],e[0]=m,e[1]=h,e[2]=n):(h=e[1],n=e[2]);k(h,n);h=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext();var o=h==="ChatTab";e[3]!==o?(n=function(){if(!c("justknobx")._("3195")||!d("MAWMediaGalleryM2Utils").isMediaGalleryM2Enabled())return;l.onReady(function(a){a=a.getFTSRestoreSync;a=a();o&&(a.setIsStarted(!1),a.setShouldPauseRestore(!0))})},e[3]=o,e[4]=n):n=e[4];var p=n;h=d("MWLSThread").useThread(f.threadKey);n=d("MWPThreadCapabilitiesContext").Provider;var q=d("MAWThreadCutover").useGetCutoverOpenThreadKey(f.threadKey),r=d("MAWThreadCutover").useCutoverSecureThreadKeyForOpenThreadKey(q==null?f.threadKey:void 0);if(h==null){c("FBLogger")("messenger_web_media").mustfix("Thread is null in media viewer for attachment with threadKey: %s",(i||(i=d("I64"))).to_string(f.threadKey));var s;e[5]===Symbol["for"]("react.memo_cache_sentinel")?(s=j.jsx(c("MWV2MediaViewerNullState.react"),{}),e[5]=s):s=e[5];return s}s=d("LSMessagingThreadTypeUtil").isArmadilloSecure(h.threadType);if(b("cr:4482")!=null){var t=r!=null?r:h.threadKey,u;e[6]!==g||e[7]!==p?(u=function(){p(),g&&g()},e[6]=g,e[7]=p,e[8]=u):u=e[8];var v;e[9]!==f||e[10]!==a||e[11]!==u||e[12]!==h?(v=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:f,onClose:u,shouldShowMessengerLogo:a,thread:h}),e[9]=f,e[10]=a,e[11]=u,e[12]=h,e[13]=v):v=e[13];e[14]!==f||e[15]!==t||e[16]!==v||e[17]!==h.threadType?(u=j.jsx(b("cr:4482"),{initialAttachment:f,secureThreadKey:t,threadType:h.threadType,children:v}),e[14]=f,e[15]=t,e[16]=v,e[17]=h.threadType,e[18]=u):u=e[18];t=u;e[19]!==t||e[20]!==h?(v=c("gkx")("1372")?j.jsx(n,{thread:h,children:t}):t,e[19]=t,e[20]=h,e[21]=v):v=e[21];return v}if((q!=null||r!=null)&&c("gkx")("2616")===!0){u=q!=null?q:h.threadKey;t=r!=null?r:h.threadKey;e[22]!==g||e[23]!==p?(v=function(){p(),g&&g()},e[22]=g,e[23]=p,e[24]=v):v=e[24];e[25]!==f||e[26]!==a||e[27]!==v||e[28]!==h?(q=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:f,onClose:v,shouldShowMessengerLogo:a,thread:h}),e[25]=f,e[26]=a,e[27]=v,e[28]=h,e[29]=q):q=e[29];e[30]!==f||e[31]!==u||e[32]!==t||e[33]!==q||e[34]!==h.threadType?(r=j.jsx(c("MWV2MediaViewerCutoverWrapper.react"),{initialAttachment:f,openThreadKey:u,secureThreadKey:t,threadType:h.threadType,children:q}),e[30]=f,e[31]=u,e[32]=t,e[33]=q,e[34]=h.threadType,e[35]=r):r=e[35];v=r;e[36]!==v||e[37]!==h?(u=c("gkx")("1372")?j.jsx(n,{thread:h,children:v}):v,e[36]=v,e[37]=h,e[38]=u):u=e[38];return u}if(s){e[39]!==g||e[40]!==p?(t=function(){p(),g&&g()},e[39]=g,e[40]=p,e[41]=t):t=e[41];e[42]!==f||e[43]!==a||e[44]!==t||e[45]!==h?(q=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:f,onClose:t,shouldShowMessengerLogo:a,thread:h}),e[42]=f,e[43]=a,e[44]=t,e[45]=h,e[46]=q):q=e[46];e[47]!==f||e[48]!==q||e[49]!==h?(r=j.jsx(c("XPlatReactFocusRegion.react"),{autoRestoreFocus:!0,children:j.jsx(c("MWV2MediaViewerSecureWrapper.react"),{initialAttachment:f,thread:h,children:q})}),e[47]=f,e[48]=q,e[49]=h,e[50]=r):r=e[50];v=r;e[51]!==v||e[52]!==h?(u=c("gkx")("1372")?j.jsx(n,{thread:h,children:v}):v,e[51]=v,e[52]=h,e[53]=u):u=e[53];return u}e[54]!==f||e[55]!==g||e[56]!==a||e[57]!==h?(s=j.jsx(c("MWV2MediaViewerContent.react"),{initialAttachment:f,onClose:g,shouldShowMessengerLogo:a,thread:h}),e[54]=f,e[55]=g,e[56]=a,e[57]=h,e[58]=s):s=e[58];e[59]!==f||e[60]!==s||e[61]!==h?(t=j.jsx(c("MWV2MediaViewerOpenWrapper.react"),{initialAttachment:f,thread:h,children:s}),e[59]=f,e[60]=s,e[61]=h,e[62]=t):t=e[62];return t}g["default"]=a}),98);
__d("MWV2MediaViewerThreadCutoverWrapper.react",["LSThreadMediaGalleryGroup","MWChatAttachmentMediaState.react","MWV2MediaViewerContext.react","cr:1977","emptyFunction","justknobx","react","react-compiler-runtime","useMAWLoadMoreCutoverThreadSharedAttachments","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl","useMWV2MediaViewerSecurePlayableUrl","useMWV2MediaViewerSecurePreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){var e=d("react-compiler-runtime").c(27),f=a.children,g=a.initialAttachment,h=a.openThreadKey,k=a.secureThreadKey;a=a.threadType;var l;e[0]!==k||e[1]!==a?(l={threadKey:k,threadType:a},e[0]=k,e[1]=a,e[2]=l):l=e[2];b("cr:1977")(l);e[3]===Symbol["for"]("react.memo_cache_sentinel")?(l={entrypoint:"media_viewer"},e[3]=l):l=e[3];var m;e[4]===Symbol["for"]("react.memo_cache_sentinel")?(m=c("justknobx")._("3233"),e[4]=m):m=e[4];k=c("useMAWLoadMoreCutoverThreadSharedAttachments")(k,h,a,l,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,!1,m);h=k.attachments;a=k.onLoadMore;var n=j,o=c("useMWV2MediaViewerOpenPreviewUrl")(),p=c("useMWV2MediaViewerOpenPlayableUrl")(),q=c("useMWV2MediaViewerOpenDownloadUrl")(),r=c("useMWV2MediaViewerSecurePreviewUrl")(),s=c("useMWV2MediaViewerSecurePlayableUrl")();e[5]!==o||e[6]!==r?(l=function(a,b,c){if(!a)return"";return!n(a)?o(a,b,c):r(a,b,c)},e[5]=o,e[6]=r,e[7]=l):l=e[7];m=l;e[8]!==p||e[9]!==s?(k=function(a,b,c){if(a==null)return"";return!n(a)?p(a,b,c):s(a,b,c)},e[8]=p,e[9]=s,e[10]=k):k=e[10];l=k;e[11]!==q||e[12]!==s?(k=function(a,b,c){if(a==null)return"";return!n(a)?q(a,b,c):s(a,b,c)},e[11]=q,e[12]=s,e[13]=k):k=e[13];k=k;var t;e[14]!==h||e[15]!==f||e[16]!==l||e[17]!==m||e[18]!==g?(t=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:h,getIsSecureThread:n,getPlayableUrl:l,getPreviewUrl:m,initialAttachment:g,children:f}),e[14]=h,e[15]=f,e[16]=l,e[17]=m,e[18]=g,e[19]=t):t=e[19];e[20]!==h||e[21]!==k||e[22]!==l||e[23]!==m||e[24]!==a||e[25]!==t?(f=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:k,getPlayableUrl:l,getPreviewUrl:m,heroLoggingComponent:c("emptyFunction"),loadMore:a,media:h,children:t}),e[20]=h,e[21]=k,e[22]=l,e[23]=m,e[24]=a,e[25]=t,e[26]=f):f=e[26];return f}function j(a){return!((a==null?void 0:a.transportKey)==="FBBroker"||(a==null?void 0:a.transportKey)==="FBLegacyBroker")}g["default"]=a}),98);
__d("useMAWBulkMaybeAutoTriggerDownload",["MAWDownloadMediaInWorkerDeferred","MAWMediaDownloadStatus","MAWStateContext.react","cr:12003","gkx","justknobx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h;f=h||d("react");var i=f.useContext,j=f.useEffect;f.useMemo;var k=f.useRef;function a(a){a=d("react-compiler-runtime").c(1);var b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=[],a[0]=b):b=a[0];return b}var l=(f=b("cr:12003"))!=null?f:a;function e(a,b){var e=d("react-compiler-runtime").c(9),f=l(a),g;e[0]!==f?(g=new Map(f.map(m)),e[0]=f,e[1]=g):g=e[1];f=g;var h=f;e[2]===Symbol["for"]("react.memo_cache_sentinel")?(g=new Map(),e[2]=g):g=e[2];var n=k(g),o=i(d("MAWStateContext.react").MAWDispatchContext);e[3]!==a||e[4]!==o||e[5]!==h||e[6]!==b?(f=function(){var e=[];a.forEach(function(a){var f,g,i=a.attachment;a=a.mediaRenderQpl;f=(f=h.get(i.attachmentFbid))!=null?f:!1;g=(g=n.current.get(i.attachmentFbid))!=null?g:!1;f&&!g&&(n.current.set(i.attachmentFbid,!0),!c("justknobx")._("3226")?d("MAWDownloadMediaInWorkerDeferred").maybeDownloadMediaInWorker({attachment:i,dispatch:o,mediaRenderQpl:a,triggerUIView:b}):e.push({attachment:i,mediaRenderQpl:a}))});e.length>0&&d("MAWDownloadMediaInWorkerDeferred").maybeBulkDownloadMediaInWorker({attachmentsWithQpl:e,dispatch:o,triggerUIView:b})},g=[a,o,n,h,b],e[3]=a,e[4]=o,e[5]=h,e[6]=b,e[7]=f,e[8]=g):(f=e[7],g=e[8]);j(f,g)}function m(a){var b;b=(a==null?void 0:(b=a.status)==null?void 0:b.mainMediaStatus)===c("MAWMediaDownloadStatus").MISSING_FILE||(a==null?void 0:(b=a.status)==null?void 0:b.mainMediaStatus)===c("MAWMediaDownloadStatus").MANUAL_RETRYABLE_FAILURE||c("gkx")("5850")&&(a==null?void 0:(b=a.status)==null?void 0:b.mainMediaStatus)===c("MAWMediaDownloadStatus").DOWNLOADING;return[a.attachment.attachmentFbid,b]}g["default"]=e}),98);
__d("useMWInboxMediaRestoreLoop",["Int64Hooks","MAWMiActOnActThreadReadyDeferred","Promise","asyncToGeneratorRuntime","promiseDone","react","react-compiler-runtime","requireDeferred","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;e=i||d("react");e.useCallback;var j=e.useState,k=c("requireDeferred")("MAWFTSRestoreSync").__setRef("useMWInboxMediaRestoreLoop");function a(a){var e=d("react-compiler-runtime").c(13),f=a.threadKey,g=c("useAsyncReStore")();a=j(null);var i=a[0],l=a[1],m;e[0]!==g||e[1]!==i||e[2]!==f?(a=function(){var a=function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield g);c("promiseDone")(c("MAWMiActOnActThreadReadyDeferred")(a,f,"mediaRestore",function(a,d){k.onReady(function(a){a=a.getMediaRestoreSync;a().setActiveThreadId(d);c("promiseDone")(a().startMediaSyncingLoop());l(a())});return(h||(h=b("Promise"))).resolve()}))});function a(){return d.apply(this,arguments)}return a}();c("promiseDone")(a());return function(){i==null?void 0:i.setIsStarted(!1),i==null?void 0:i.setShouldPauseRestore(!0)}},m=[g,i,f],e[0]=g,e[1]=i,e[2]=f,e[3]=a,e[4]=m):(a=e[3],m=e[4]);d("Int64Hooks").useEffectInt64(a,m);e[5]!==i?(a=function(){i!=null&&(i.resetEBAvailability(),i.isStarted()||c("promiseDone")(i.startMediaSyncingLoop()))},e[5]=i,e[6]=a):a=e[6];var n=a;e[7]!==i?(m=function(){i!=null&&(i.isStarted()||c("promiseDone")(i.startMediaSyncingLoop()))},e[7]=i,e[8]=m):m=e[8];var o=m;e[9]!==n||e[10]!==o?(a=function(){return{onEBOnboarded:n,startMediaSync:o}},m=[n,o],e[9]=n,e[10]=o,e[11]=a,e[12]=m):(a=e[11],m=e[12]);return d("Int64Hooks").useMemoInt64(a,m)}g["default"]=a}),98);