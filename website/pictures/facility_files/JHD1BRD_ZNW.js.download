;/*FB_PKG_DELIM*/

__d("LSSyncBumpThreadDataToClient",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.filter(b.db.table(9).fetch([[[a[0]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&b.i64.ge(a[1],c.lastActivityTimestampMs)}).next().then(function(c,d){var e=c.done;c=c.value;return e?0:(d=c.item,b.sequence([function(c){return b.forEach(b.db.table(9).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({lastActivityTimestampMs:a[1]})})},function(c){return b.i64.eq(a[2],b.i64.cast([0,1]))?b.forEach(b.db.table(9).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({lastReadWatermarkTimestampMs:a[1]})}):b.i64.eq(a[2],b.i64.cast([0,2]))?b.resolve(0):b.i64.eq(a[2],b.i64.cast([0,3]))?b.i64.ge(d.lastReadWatermarkTimestampMs,d.lastActivityTimestampMs)?b.forEach(b.db.table(9).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({lastReadWatermarkTimestampMs:a[1]})}):b.resolve():b.resolve(0)}]))})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxSyncBumpThreadDataToClientStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);